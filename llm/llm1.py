import ollama
def ollama_image_caption(msg):
    client = ollama.Client(host='http://localhost:11434')
    # 设置提示语，引导模型对图片进行描述
    prompt_v = msg or "hello world"
    response = client.generate(
        model='llava', prompt=prompt_v)
    return response

# 调用
# 指令内容，使用 ``` 来分隔指令和待总结的内容
text = f"""
您应该提供尽可能清晰、具体的指示，以表达您希望模型执行的任务。\
这将引导模型朝向所需的输出，并降低收到无关或不正确响应的可能性。\
不要将写清晰的提示词与写简短的提示词混淆。\
在许多情况下，更长的提示词可以为模型提供更多的清晰度和上下文信息，从而导致更详细和相关的输出。
"""
# 需要总结的文本内容
prompt = f"""
把用三个反引号括起来的文本总结成一句话。
```{text}```
"""

caption = ollama_image_caption(prompt)

print(caption)

'''
model='llava' 
created_at='2025-02-12T10:32:06.178814Z' 
done=True 
done_reason='stop' 
total_duration=28396676752 
load_duration=7312333572 
prompt_eval_count=177
prompt_eval_duration=15460000000 
eval_count=44 eval_duration=5615000000 
response=' 提供清晰、具体的指示，帮助引导模型执行任务，降低收到无关或不正确响应的可能性。 ' 
context=[733, 16289, 28793, 28705, 13, 29855, 28963, 29492, 28995, 30004, 29544, 29170, 30574, 29676, 29263, 28914, 29019, 29119, 29758, 29218, 29025, 28969, 30347, 29456, 28944, 13, 13940, 28832, 13, 29689, 29298, 29350, 29279, 29954, 31430, 29052, 29084, 29649, 233, 156, 179, 29041, 29737, 29337, 28914, 29223, 29073, 28924, 29074, 29024, 30079, 29689, 30655, 30606, 29266, 29173, 29556, 29037, 28914, 29454, 29224, 28944, 29176, 29248, 29544, 29773, 29266, 29173, 30746, 29478, 29163, 29259, 28914, 29226, 29065, 28924, 29457, 30852, 30456, 29507, 29036, 29375, 29229, 29355, 28988, 29302, 29529, 30249, 29298, 28914, 29052, 29084, 29261, 28944, 28988, 29059, 29248, 29503, 29649, 233, 156, 179, 28914, 29279, 29073, 30352, 29551, 29503, 30470, 30132, 28914, 29279, 29073, 30352, 31493, 233, 186, 137, 28944, 29010, 30048, 29292, 29418, 30181, 29061, 28924, 29250, 29495, 28914, 29279, 29073, 30352, 29052, 29074, 29003, 29266, 29173, 29279, 29954, 29250, 29292, 28914, 29649, 233, 156, 179, 29184, 29131, 29054, 29061, 29019, 29080, 29069, 28924, 29505, 29746, 29773, 30176, 29250, 29852, 30044, 29131, 29367, 29229, 28914, 29226, 29065, 28944, 13, 13940, 28832, 13, 733, 28748, 16289, 28793, 28705, 29279, 29954, 29649, 233, 156, 179, 29041, 29737, 29337, 28914, 29223, 29073, 28924, 31186, 30278, 29544, 29773, 29266, 29173, 29556, 29037, 29454, 29224, 28924, 30852, 30456, 29507, 29036, 29375, 29229, 29355, 28988, 29302, 29529, 30249, 29298, 28914, 29052, 29084, 29261, 28944, 28705]
'''