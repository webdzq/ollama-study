import ollama
def ollama_image_caption(msg):
    client = ollama.Client(host='http://localhost:11434')
    # 设置提示语
    prompt_v = msg or "hello world"
    response = client.generate(
        model='llava', prompt=prompt_v)
    return response

# 调用
# 指令内容，使用 ``` 来分隔指令和待总结的内容
prompt = f"""
您的任务是以一致的风格回答问题。

<孩子>: 请教我何为耐心。

<祖父母>: 挖出最深峡谷的河流源于一处不起眼的泉眼；最宏伟的交响乐从单一的音符开始；最复杂的挂毯以一根孤独的线开始编织。

<孩子>: 请教我何为韧性。
"""

caption = ollama_image_caption(prompt)

print(caption)

'''
{
    'model': 'llava',
    'created_at': '2024-10-30T10:09:14.546746Z',
    'response': ' <祖父母>: 韧性是指在面对突然变化、强力的冲击或挑战时能够快速适应并保持稳定的精神状态。就像一只海豚可以根据海洋水流而立即改变 swim path，避免碰撞到陷阱。 ',
    'done': True,
    'done_reason': 'stop',
    'context': [733, 16289, 28793, 28705, 13, 29689, 28914, 29454, 29224, 28971, 29074, 28969, 30176, 28914, 30206,
        29293, 29034, 30620, 29562, 29264, 28944, 13, 13, 28789, 31437, 29169, 9670, 28705, 29067, 30166, 29242,
        29984, 29003, 235, 131, 147, 29574, 28944, 13, 13, 28789, 31499, 30276, 30518, 9670, 28705, 233, 143, 153,
        29065, 29190, 30330, 232, 182, 164, 30894, 28914, 30143, 29642, 29512, 29160, 28969, 29326, 28988, 29676,
        31112, 28914, 31271, 31112, 29743, 29190, 31934, 231, 191, 162, 28914, 29471, 30249, 30488, 29505, 29113,
        28969, 28914, 29838, 29252, 29177, 29197, 29743, 29190, 29284, 31122, 28914, 31431, 233, 178, 178, 29074,
        28969, 29521, 232, 176, 167, 30843, 28914, 29437, 29177, 29197, 29402, 31500, 28944, 13, 13, 28789, 31437,
        29169, 9670, 28705, 29067, 30166, 29242, 29984, 29003, 236, 162, 170, 29261, 28944, 13, 733, 28748, 16289,
        28793, 523, 31499, 30276, 30518, 9670, 28705, 236, 162, 170, 29261, 28971, 29223, 29010, 29181, 29051,
        31125, 29713, 29389, 29192, 29041, 30283, 29588, 28914, 30745, 29698, 29355, 233, 143, 148, 30272, 29007,
        29084, 31194, 30059, 30029, 30640, 29298, 29457, 29321, 29569, 234, 171, 182, 29018, 28914, 30170, 29836,
        29334, 29283, 28944, 29379, 29663, 28969, 29405, 29726, 235, 180, 157, 29052, 29074, 29521, 29020, 29726,
        31434, 29692, 29642, 29746, 29831, 29898, 29220, 29389, 10923, 2439, 28924, 31059, 30596, 234, 165, 179,
        233, 149, 161, 29036, 236, 156, 186, 236, 155, 180, 28944, 28705],
    'total_duration': 63673610069,
    'load_duration': 10896315585,
    'prompt_eval_count': 133,
    'prompt_eval_duration': 19784767000,
    'eval_count': 92,
    'eval_duration': 32978750000
}

'''